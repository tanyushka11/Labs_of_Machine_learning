Исследование факторов и организация работы с таблицами данных

Работу выполнила Бобина Татьяна Сергеевна
Данные: Статистика о государственных закупках лекарственных препаратов в 2021 году согласно Единой информационной системе в сфере закупок.
Скачиваем набор данных и проверяем корректность загрузки
#### Описание данных
- first_pub_date – дата публикации процедуры
* final_protocol_pub_date – дата завершения процедуры
+ purchase_number – идентификатор процедуры
* collecting_start_date – дата начала сбора заявок от потенциальных поставщиков
* collecting_end_date – дата окончания сбора заявок от потенциальных поставщиков
* placing_base_name – форма проведения торгов (конкурс, аукцион и т.п.)
* cust_reg – регион заказчика процедуры
* lot_price_correct – максимально возможная, объявленная заказчиком, цена за все препараты в закупке
* drug_mnn_ext_code – идентификатор лекарственного препарата
* drug_mnn_name – наименование лекарственного препарата (их меньше, чем drug_mnn_ext_code)
* drug_qty – объем закупаемого лекарственного препарата
* drug_price – цена за единицу объема закупаемого лекарственного препарата
* drug_position_price – цена за всю позицию закупаемого лекарственного препарата
* ftg – класс закупаемого лекарственного препарата
* is_abnd – фиктивная переменная: 1 – закупка не состоялась, 0 – состоялась
* is_znvlp – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат из списка ЖВЛП, 0 – не содержатся
* is_narcotic – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат, в составе которого есть наркотические вещества, 0 – не содержатся
* is_msp_purchase – фиктивная переменная: 1 – закупка предназначена только для субъектов малого и среднего предпринимательства, 0 – не предназначена
* is_povt – фиктивная переменная: 1 – эту процедуру заказчик вынужден повторить, 0 – не повторная
* is_dif – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат, являющийся дефицитным, 0 – не содержатся
* app_amount_absolute_correct – сумма залога
* advance_sum_correct – сумма аванса

##### Наибольшее  влияние на вероятность незакрытия закупки оказывают следующие факторы:
+ `placing_base_name` - разные формы проведения торгов могут иметь разную степень конкуренции 
+ `lot_price_correct` - чем ниже максимально возможная цена, объявленная заказчиком, тем меньше вероятность, что найдется поставщик, готовый выполнить заказ по данной цене.
+ `drug_qty` - может не быть в наличие нужный объем препарата
+ `drug_price` - не подходящая цена, может помешать слелать закупку
+ `drug_position_price` - аналогично
+ `is_narcotic` - содержание наркотических веществ, может повлечь незакрытие закупки
+ `is_dif` - закупка дефицитных препаратов может быть более сложной из-за доступности препаратов
###### Помимо представленных в наборе факторов, может повлиять на незакрытие закупки:

+ `product_quality` - 1-товар ненадлежащего качества, 0-качественный товар
+ `complaints` - 1-были жалобы на товар, 0-жалоб не было
+ `deliver_on_time` - 1-товар не смогут доставить в срок, 0-смогут доставить в срок товар

# сгруппируем данные по purchase_number

### Формирование факторов

Фактор `is_most_expensive` - фиктивная переменная: 1 - если drug_position_price выше 70-го процентиля всех значений в этом столбце, 0 - в противном случае. Он прказывает, является ли закупка дорогой.

##### Фактор, полученный с помощью метода главных компонент:
Фактор `new_feature` - это фактор, полученный с помощью метода главных компонент из исходных столбцов с информацией о покупках. Этот фактор является линейной комбинацией исходных факторов, которые наилучшим образом объясняют вариацию в данных.

##### Факторы, полученные с помощью простейших арифметических операций:

Фактор `amount_drug` - это фактор, который представляет количество препоратов в закупке. Вычисляется как отношение цены за всю позицию закупаемого лекарственного препарата к цена за единицу объема закупаемого лекарственного препарата.

# преобразуем категориальную переменную `placing_base_name`

Разделяем на обучающую и тестовую выборки
Оценка важности выделенных факторов на основе метода "Случайного леса"
https://skr.sh/sJ95TfCSd0f?a
